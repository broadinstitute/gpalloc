// a test DB is required.  Here's an example command to run one locally

//docker run --name mysql-gpalloc \
// -e MYSQL_ROOT_PASSWORD=gpalloc-test \
// -e MYSQL_USER=gpalloc-test \
// -e MYSQL_PASSWORD=gpalloc-test \
// -e MYSQL_DATABASE=gpalloc \
// -d -p 3306:3306 mysql/mysql-server:5.6

gpalloc {
  projectMonitorPollInterval = 5 seconds
  abandonmentTime = 2 hours
  abandonmentSweepInterval = 10 minutes
  minimumFreeProjects = 5
  projectPrefix = gpalloc-test

  #GCP quota is one CreateProject operation per second.
  #https://cloud.google.com/resource-manager/docs/limits
  projectsPerSecondThrottle = 1

  #The quota for GCP serviceUsage is 200 per 100s.
  #still, we'll lowball here.
  #https://cloud.google.com/service-usage/docs/pricing-and-quotas
  opsThrottle = 15
  opsThrottlePerDuration = 10 second

  #There's also a second serviceUsage quota of 20 mutate tickets
  #per 100 seconds. A batchEnable call eats 5 mutate tickets.
  #We got the mutate limit bumped to 500 calls per 100s, i.e.
  #100 batchEnable calls per 100 seconds, i.e. 1 per second.
  enableThrottle = 10
  enableThrottlePerDuration = 15 seconds
}

mysql {
  profile = "slick.jdbc.MySQLProfile$"
  batchSize = 5000
  host = "localhost"
  host = ${?MYSQL_HOST}
  port = 3306
  port = ${?MYSQL_PORT}
  db {
    driver = "com.mysql.cj.jdbc.Driver"
    url = "jdbc:mysql://"${mysql.host}":"${mysql.port}"/gpalloctestdb?createDatabaseIfNotExist=true&useSSL=false&rewriteBatchedStatements=true&nullNamePatternMatchesAll=true"
    user = "gpalloc-test"
    password = "gpalloc-test"
    connectionTimeout = "5 seconds"  // default of 1 sec sometimes too short for docker local mysql
  }
}

liquibase {
  changelog = "org/broadinstitute/dsde/workbench/gpalloc/liquibase/changelog.xml"
  initWithLiquibase = true
}

swagger {
  googleClientId = "test.apps.googleusercontent.com"
  realm = "broad-dsde-test"
}
